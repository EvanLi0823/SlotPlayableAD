# Slot老虎机测试用例文档

## 项目信息
- **项目名称**: MySlotPlayableAD
- **引擎版本**: Cocos Creator 2.4.11
- **文档版本**: v1.0
- **最后更新**: 2025-12-25
- **关联设计文档**: SlotMachine_Design_Document.md

---

## 一、测试环境配置

### 1.1 测试设备要求
- **iOS设备**: iPhone 8及以上，iOS 12+
- **Android设备**: 主流机型，Android 7.0+
- **浏览器**: Chrome 90+, Safari 14+
- **分辨率**: 720x1280, 1080x1920, 1125x2436

### 1.2 测试数据准备
- **Symbol资源**: 10种symbol图片（symbol_0.png ~ symbol_9.png）
- **动画帧序列**: 每个symbol的中奖动画帧序列（8-20帧）
- **测试配置**:
  - 初始布局配置文件
  - 预设的测试结果数据（至少5组）

### 1.3 性能基准
- **目标FPS**: 60
- **最大DrawCall**: <50
- **最大内存占用**: <100MB
- **单次Spin耗时**: 3-5秒

---

## 二、功能测试用例

### 2.1 初始化模块

#### TC-INIT-001: 初始布局显示
- **优先级**: P0（核心功能）
- **前置条件**:
  - 已加载所有symbol资源
  - 配置了有效的初始布局数据
- **测试步骤**:
  1. 启动游戏场景
  2. 观察老虎机初始状态
  3. 验证3行5列的布局是否正确显示
- **预期结果**:
  - 显示3行5列共15个symbol
  - 每个symbol位置与配置的初始布局一致
  - Symbol图片清晰无失真
  - Symbol间距为4px
  - 整体布局居中对齐
- **测试数据**:
```json
{
  "initialLayout": [
    [1, 3, 5, 7, 2],
    [4, 6, 8, 3, 5],
    [2, 9, 1, 4, 6]
  ]
}
```

#### TC-INIT-002: Symbol资源加载验证
- **优先级**: P0
- **前置条件**: 资源目录包含所有symbol图片
- **测试步骤**:
  1. 启动游戏
  2. 检查控制台日志
  3. 验证所有symbol是否加载成功
- **预期结果**:
  - 10种symbol全部加载成功
  - 无资源加载错误日志
  - 所有symbol图片渲染正常

#### TC-INIT-003: 动画配置加载验证
- **优先级**: P1
- **前置条件**:
  - 动画配置文件存在
  - 所有帧序列资源已准备
- **测试步骤**:
  1. 启动游戏
  2. 检查动画配置是否正确加载
  3. 验证每个symbol的帧序列数量
- **预期结果**:
  - 10个symbol的动画配置全部加载
  - 每个symbol至少有8帧动画
  - 帧率配置在12-24fps范围内

#### TC-INIT-004: 尺寸和布局验证
- **优先级**: P1
- **前置条件**: 已完成初始化
- **测试步骤**:
  1. 测量滚轮区域总尺寸
  2. 测量单个symbol显示尺寸
  3. 测量symbol间距
- **预期结果**:
  - 滚轮区域: 340px × 180px
  - 单个symbol: 64px × 56px
  - Symbol间距: 4px
  - 实际占用宽度: 336px
  - 实际占用高度: 176px

---

### 2.2 Spin按钮模块

#### TC-BTN-001: Spin按钮基本功能
- **优先级**: P0
- **前置条件**: 老虎机处于IDLE状态
- **测试步骤**:
  1. 点击Spin按钮
  2. 观察按钮状态变化
  3. 观察滚轴是否开始旋转
- **预期结果**:
  - 按钮立即变为禁用状态
  - 按钮显示按下动画
  - 所有滚轴开始旋转
  - 状态变为SPINNING

#### TC-BTN-002: Spin按钮禁用状态
- **优先级**: P0
- **前置条件**: 正在执行spin操作（状态为SPINNING）
- **测试步骤**:
  1. 在滚轴旋转过程中点击Spin按钮
  2. 观察按钮响应
- **预期结果**:
  - 按钮保持禁用状态
  - 点击无响应
  - 不触发新的spin
  - 当前spin继续正常执行

#### TC-BTN-003: Spin完成后按钮恢复
- **优先级**: P0
- **前置条件**: Spin操作正在执行
- **测试步骤**:
  1. 等待spin完成（包括中奖动画）
  2. 观察按钮状态
- **预期结果**:
  - 所有动画完成后按钮自动恢复可用状态
  - 状态变为IDLE
  - 可以再次点击触发新的spin

#### TC-BTN-004: 连续快速点击
- **优先级**: P1
- **前置条件**: 按钮处于可用状态
- **测试步骤**:
  1. 在1秒内快速点击按钮10次
  2. 观察系统响应
- **预期结果**:
  - 只触发一次spin
  - 后续点击被忽略
  - 无错误或崩溃
  - 动画流程正常完成

---

### 2.3 滚动动画模块

#### TC-SPIN-001: 基本滚动动画
- **优先级**: P0
- **前置条件**:
  - 点击Spin按钮
  - 已配置spin结果数据
- **测试步骤**:
  1. 点击Spin按钮
  2. 观察5个滚轴的滚动动画
  3. 记录动画各阶段时长
- **预期结果**:
  - 5个滚轴同时开始滚动
  - 加速阶段: 0.2秒
  - 匀速阶段: ≥1.3秒（至少到1.5秒）
  - 滚动流畅，无卡顿
  - Symbol向下滚动（正确的方向）

#### TC-SPIN-002: 加速阶段验证
- **优先级**: P1
- **前置条件**: 刚点击Spin按钮
- **测试步骤**:
  1. 观察滚动开始的前0.2秒
  2. 验证速度变化
- **预期结果**:
  - 速度从0逐渐增加
  - 0.2秒后达到匀速（800像素/秒）
  - 加速过程平滑无突变

#### TC-SPIN-003: 匀速阶段验证
- **优先级**: P1
- **前置条件**: 滚动已进入匀速阶段
- **测试步骤**:
  1. 观察0.2秒~1.5秒之间的滚动
  2. 测量滚动速度
- **预期结果**:
  - 速度保持恒定（800像素/秒）
  - Symbol循环出现
  - 滚动平滑无抖动

#### TC-SPIN-004: Symbol循环机制
- **优先级**: P1
- **前置条件**: 滚轴正在匀速滚动
- **测试步骤**:
  1. 观察symbol的循环出现
  2. 验证是否有symbol重复出现
- **预期结果**:
  - Symbol滚出底部后在顶部重新出现
  - 每列有7个symbol节点循环使用
  - 匀速阶段显示随机symbol
  - 无空白或重复

---

### 2.4 停止机制模块

#### TC-STOP-001: 逐列停止时序
- **优先级**: P0
- **前置条件**: 滚轴正在旋转
- **测试步骤**:
  1. 观察5个滚轴的停止顺序
  2. 测量每列停止的时间间隔
- **预期结果**:
  - t=1.5s: Reel_0开始减速
  - t=1.7s: Reel_1开始减速（延迟0.2s）
  - t=1.9s: Reel_2开始减速（延迟0.2s）
  - t=2.1s: Reel_3开始减速（延迟0.2s）
  - t=2.3s: Reel_4开始减速（延迟0.2s）
  - 每列间隔准确为0.2秒

#### TC-STOP-002: 减速阶段验证
- **优先级**: P1
- **前置条件**: 滚轴开始减速
- **测试步骤**:
  1. 观察减速阶段的动画
  2. 测量减速时长
- **预期结果**:
  - 减速时长: 0.5秒
  - 速度从800逐渐降到0
  - 使用缓动函数（EaseOut）
  - 减速平滑自然

#### TC-STOP-003: 精确停止位置
- **优先级**: P0（核心功能）
- **前置条件**:
  - 配置了明确的finalLayout
  - 滚轴正在减速
- **测试步骤**:
  1. 等待滚轴完全停止
  2. 对比当前显示与预设的finalLayout
  3. 验证每个位置的symbol ID
- **预期结果**:
  - 所有15个symbol位置完全匹配finalLayout
  - 无位置偏移或错位
  - Symbol对齐到网格中心
- **测试数据**:
```json
{
  "finalLayout": [
    [3, 7, 2, 9, 5],
    [7, 7, 7, 7, 7],
    [2, 8, 2, 5, 9]
  ]
}
```

#### TC-STOP-004: 回弹效果
- **优先级**: P1
- **前置条件**: 滚轴刚完成减速停止
- **测试步骤**:
  1. 观察停止后的回弹动画
  2. 测量回弹距离和时长
- **预期结果**:
  - 向下移动8px（0.15秒）
  - 回到原位8px（0.15秒）
  - 回弹自然有弹性
  - 总耗时约0.3秒

#### TC-STOP-005: 多次Spin停止一致性
- **优先级**: P1
- **前置条件**: 准备相同的结果数据
- **测试步骤**:
  1. 连续执行3次spin，使用相同的finalLayout
  2. 每次验证停止位置
- **预期结果**:
  - 3次停止位置完全一致
  - 无随机偏差
  - 精度误差<1px

---

### 2.5 中奖动画模块

#### TC-WIN-001: 中奖动画触发
- **优先级**: P0
- **前置条件**:
  - 滚轴全部停止
  - 结果包含中奖位置
- **测试步骤**:
  1. 等待滚轴停止
  2. 观察中奖动画触发时机
- **预期结果**:
  - 滚轴停止后延迟0.3秒
  - 中奖symbol开始播放动画
  - 非中奖symbol保持静止
- **测试数据**:
```json
{
  "winPositions": [
    {"row": 1, "col": 0, "symbolId": 7},
    {"row": 1, "col": 1, "symbolId": 7},
    {"row": 1, "col": 2, "symbolId": 7},
    {"row": 1, "col": 3, "symbolId": 7},
    {"row": 1, "col": 4, "symbolId": 7}
  ]
}
```

#### TC-WIN-002: 帧动画播放
- **优先级**: P0
- **前置条件**: 中奖动画开始播放
- **测试步骤**:
  1. 观察帧动画播放过程
  2. 验证帧序列完整性
  3. 测量帧率
- **预期结果**:
  - 按配置的帧序列顺序播放
  - 帧率符合配置（15fps）
  - 帧切换流畅无跳帧
  - 每帧持续时间约0.067秒

#### TC-WIN-003: 动画循环次数
- **优先级**: P1
- **前置条件**: 配置了loopCount=3
- **测试步骤**:
  1. 计数动画播放次数
  2. 观察动画结束后状态
- **预期结果**:
  - 动画精确播放3次循环
  - 每次循环完整播放所有帧
  - 循环间隔0.1秒
  - 结束后恢复normal状态

#### TC-WIN-004: 缩放效果（如果启用）
- **优先级**: P2
- **前置条件**:
  - Symbol配置了extraScale.enabled=true
  - scaleTo=1.1
- **测试步骤**:
  1. 观察动画播放时的缩放效果
  2. 测量缩放倍数
- **预期结果**:
  - 播放时放大到1.1倍
  - 缩放动画时长0.1秒
  - 结束后恢复1.0倍
  - 缩放平滑无突变

#### TC-WIN-005: 同时播放模式（SIMULTANEOUS）
- **优先级**: P1
- **前置条件**: 配置mode=SIMULTANEOUS
- **测试步骤**:
  1. 触发有多个中奖symbol的结果
  2. 观察所有中奖symbol的动画
- **预期结果**:
  - 所有中奖symbol同时开始播放
  - 所有动画同步进行
  - 所有动画同时结束

#### TC-WIN-006: 按线播放模式（BY_LINE）
- **优先级**: P2
- **前置条件**:
  - 配置mode=BY_LINE
  - 结果包含多条中奖线
- **测试步骤**:
  1. 触发多线中奖结果
  2. 观察动画播放顺序
- **预期结果**:
  - 第一条线播放完成后播放第二条
  - 每条线内的symbol同时播放
  - 线与线之间延迟0.2秒

#### TC-WIN-007: 顺序播放模式（SEQUENTIAL）
- **优先级**: P2
- **前置条件**: 配置mode=SEQUENTIAL
- **测试步骤**:
  1. 触发多个中奖symbol
  2. 观察播放顺序
- **预期结果**:
  - 从左到右、从上到下依次播放
  - 每个symbol间隔0.1秒
  - 顺序符合预期

#### TC-WIN-008: 无中奖情况
- **优先级**: P1
- **前置条件**: 结果的winPositions为空数组
- **测试步骤**:
  1. 执行无中奖的spin
  2. 观察停止后行为
- **预期结果**:
  - 滚轴停止后延迟0.3秒
  - 不播放任何中奖动画
  - 直接返回IDLE状态
  - 按钮恢复可用

#### TC-WIN-009: 全屏中奖
- **优先级**: P1
- **前置条件**: 所有15个位置都在winPositions中
- **测试步骤**:
  1. 执行全屏中奖的spin
  2. 观察动画播放
- **预期结果**:
  - 15个symbol同时播放动画
  - 动画流畅无卡顿
  - FPS保持60
  - 动画完成后正常返回

---

### 2.6 状态管理模块

#### TC-STATE-001: 状态转换流程
- **优先级**: P0
- **前置条件**: 完整执行一次spin
- **测试步骤**:
  1. 记录整个spin过程的状态变化
  2. 验证状态转换顺序
- **预期结果**:
  - IDLE → SPINNING → STOPPING → STOPPED → WIN_ANIMATION → IDLE
  - 状态转换时机准确
  - 无状态跳跃或错误

#### TC-STATE-002: 状态查询接口
- **优先级**: P1
- **前置条件**: 调用getState()方法
- **测试步骤**:
  1. 在不同阶段调用getState()
  2. 验证返回值
- **预期结果**:
  - 返回正确的当前状态
  - 实时更新
  - 无延迟

#### TC-STATE-003: 状态一致性
- **优先级**: P1
- **前置条件**: 执行多次spin
- **测试步骤**:
  1. 连续执行10次spin
  2. 验证每次的状态流转
- **预期结果**:
  - 每次状态流转一致
  - 无状态异常或卡住
  - 最终都返回IDLE

---

## 三、边界测试用例

### 3.1 异常数据测试

#### TC-EDGE-001: 非法symbol ID
- **优先级**: P1
- **前置条件**: 配置包含超出范围的symbol ID
- **测试步骤**:
  1. 设置finalLayout包含symbolId=10（超出0-9范围）
  2. 执行spin
- **预期结果**:
  - ResultManager验证失败
  - 输出错误日志
  - 不执行spin或使用默认值

#### TC-EDGE-002: 布局尺寸错误
- **优先级**: P1
- **前置条件**: 提供4行5列的布局数据
- **测试步骤**:
  1. 设置错误尺寸的布局
  2. 调用init()
- **预期结果**:
  - 验证失败
  - 输出错误提示
  - 使用默认布局或拒绝初始化

#### TC-EDGE-003: 空布局数据
- **优先级**: P1
- **前置条件**: 传入空数组或null
- **测试步骤**:
  1. init(null)或init([])
  2. 观察系统响应
- **预期结果**:
  - 捕获异常
  - 输出错误日志
  - 使用默认布局或安全退出

#### TC-EDGE-004: winPosition与finalLayout不匹配
- **优先级**: P1
- **前置条件**:
  - finalLayout[1][2] = 5
  - winPositions包含{row:1, col:2, symbolId:7}
- **测试步骤**:
  1. 执行spin
  2. 观察验证结果
- **预期结果**:
  - ResultManager检测到不一致
  - 输出警告或错误
  - 拒绝执行或修正数据

---

### 3.2 极端场景测试

#### TC-EDGE-005: 所有symbol相同
- **优先级**: P2
- **前置条件**: finalLayout所有位置都是同一个symbol
- **测试步骤**:
  1. 设置全部为symbol_7
  2. 执行spin
- **预期结果**:
  - 正常显示和停止
  - 如果全部中奖，播放15个动画
  - 性能正常

#### TC-EDGE-006: 所有symbol不同
- **优先级**: P2
- **前置条件**: finalLayout所有位置都不重复
- **测试步骤**:
  1. 设置15个不同的symbol组合
  2. 执行spin
- **预期结果**:
  - 正常显示和停止
  - 位置准确
  - 无中奖动画

#### TC-EDGE-007: 单个symbol中奖
- **优先级**: P2
- **前置条件**: winPositions只包含1个位置
- **测试步骤**:
  1. 执行spin
  2. 观察动画
- **预期结果**:
  - 只有1个symbol播放动画
  - 其他保持静止
  - 流程正常完成

#### TC-EDGE-008: 连续100次spin
- **优先级**: P1
- **前置条件**: 自动化脚本执行
- **测试步骤**:
  1. 编写脚本连续执行100次spin
  2. 监控内存和性能
- **预期结果**:
  - 全部成功完成
  - 内存无持续增长
  - FPS保持稳定
  - 无崩溃或错误

#### TC-EDGE-009: 极短时间间隔spin
- **优先级**: P1
- **前置条件**: 每次spin完成后立即点击
- **测试步骤**:
  1. 连续快速执行20次spin
  2. 监控系统状态
- **预期结果**:
  - 每次都正常执行
  - 状态转换正确
  - 无状态混乱
  - 无内存泄漏

---

### 3.3 资源异常测试

#### TC-EDGE-010: 缺失symbol图片
- **优先级**: P1
- **前置条件**: 删除symbol_5.png
- **测试步骤**:
  1. 启动游戏
  2. 执行包含symbol_5的spin
- **预期结果**:
  - 显示默认占位图或空白
  - 输出资源加载失败日志
  - 其他功能不受影响

#### TC-EDGE-011: 缺失动画帧序列
- **优先级**: P2
- **前置条件**: 删除symbol_7的win动画帧
- **测试步骤**:
  1. 执行symbol_7中奖
  2. 观察动画播放
- **预期结果**:
  - 跳过动画或显示静态symbol
  - 输出警告日志
  - 流程继续执行不中断

#### TC-EDGE-012: 动画帧序列不完整
- **优先级**: P2
- **前置条件**: 只有3帧动画，配置要求8帧
- **测试步骤**:
  1. 播放中奖动画
  2. 观察播放效果
- **预期结果**:
  - 循环播放现有的3帧
  - 或播放完现有帧后停止
  - 不崩溃

---

## 四、性能测试用例

### 4.1 帧率测试

#### TC-PERF-001: 正常spin的FPS
- **优先级**: P0
- **前置条件**: 标准测试设备
- **测试步骤**:
  1. 执行10次完整spin
  2. 记录每次的FPS数据
- **预期结果**:
  - 平均FPS ≥ 58
  - 最低FPS ≥ 55
  - 无明显掉帧

#### TC-PERF-002: 全屏中奖动画FPS
- **优先级**: P1
- **前置条件**: 15个symbol同时播放动画
- **测试步骤**:
  1. 执行全屏中奖spin
  2. 记录动画播放期间的FPS
- **预期结果**:
  - 平均FPS ≥ 55
  - 最低FPS ≥ 50
  - 动画流畅

#### TC-PERF-003: 长时间运行FPS稳定性
- **优先级**: P1
- **前置条件**: 连续运行30分钟
- **测试步骤**:
  1. 自动化执行spin 200次以上
  2. 每10次记录一次FPS
- **预期结果**:
  - FPS无持续下降趋势
  - 始终保持在55-60范围
  - 无性能衰减

---

### 4.2 内存测试

#### TC-PERF-004: 初始内存占用
- **优先级**: P1
- **前置条件**: 游戏刚启动完成
- **测试步骤**:
  1. 记录初始内存占用
  2. 对比不同设备
- **预期结果**:
  - iOS设备: <80MB
  - Android设备: <100MB
  - WebGL: <120MB

#### TC-PERF-005: Spin过程内存变化
- **优先级**: P1
- **前置条件**: 执行一次完整spin
- **测试步骤**:
  1. 记录spin前内存
  2. 执行spin
  3. 记录spin后内存
- **预期结果**:
  - 内存增长<5MB
  - GC后恢复到初始水平

#### TC-PERF-006: 内存泄漏检测
- **优先级**: P0
- **前置条件**: 执行100次spin
- **测试步骤**:
  1. 记录初始内存M1
  2. 执行100次spin
  3. 手动触发GC
  4. 记录最终内存M2
- **预期结果**:
  - M2 - M1 < 10MB
  - 无持续增长趋势
  - 对象池正常回收

---

### 4.3 渲染性能测试

#### TC-PERF-007: DrawCall统计
- **优先级**: P1
- **前置条件**: 启用性能统计
- **测试步骤**:
  1. 在不同阶段记录DrawCall
  2. 分析DrawCall构成
- **预期结果**:
  - 静态显示: <20 DC
  - 滚动阶段: <35 DC
  - 动画播放: <50 DC

#### TC-PERF-008: 纹理内存占用
- **优先级**: P2
- **前置条件**: 加载所有资源
- **测试步骤**:
  1. 统计纹理内存占用
  2. 验证是否使用SpriteAtlas
- **预期结果**:
  - 总纹理内存<30MB
  - 使用SpriteAtlas合批
  - 无重复纹理加载

#### TC-PERF-009: CPU占用率
- **优先级**: P2
- **前置条件**: 正常spin运行中
- **测试步骤**:
  1. 监控CPU占用率
  2. 记录峰值和平均值
- **预期结果**:
  - 平均CPU占用<30%
  - 峰值CPU占用<50%
  - 无CPU满载情况

---

### 4.4 加载性能测试

#### TC-PERF-010: 资源加载时间
- **优先级**: P1
- **前置条件**: 首次启动游戏
- **测试步骤**:
  1. 记录资源加载开始时间
  2. 记录加载完成时间
  3. 计算总耗时
- **预期结果**:
  - 总加载时间<3秒
  - Symbol资源<1秒
  - 动画帧序列<2秒

#### TC-PERF-011: 初始化时间
- **优先级**: P2
- **前置条件**: 资源加载完成
- **测试步骤**:
  1. 记录init()调用开始
  2. 记录初始布局显示完成
- **预期结果**:
  - 初始化耗时<500ms
  - 界面显示流畅

---

## 五、兼容性测试用例

### 5.1 设备兼容性

#### TC-COMPAT-001: iOS设备测试
- **优先级**: P0
- **测试设备**:
  - iPhone 8 (iOS 12)
  - iPhone 11 (iOS 14)
  - iPhone 13 (iOS 15)
  - iPad Air (iOS 14)
- **测试步骤**:
  1. 在各设备上执行核心功能
  2. 验证显示和性能
- **预期结果**:
  - 所有功能正常
  - 性能达标
  - 无崩溃

#### TC-COMPAT-002: Android设备测试
- **优先级**: P0
- **测试设备**:
  - Samsung Galaxy S10 (Android 10)
  - Xiaomi Mi 10 (Android 11)
  - Huawei P30 (Android 9)
  - OnePlus 8 (Android 11)
- **测试步骤**:
  1. 在各设备上执行核心功能
  2. 验证显示和性能
- **预期结果**:
  - 所有功能正常
  - 性能达标
  - 无崩溃
  - 无严重发热

#### TC-COMPAT-003: 浏览器兼容性
- **优先级**: P1
- **测试浏览器**:
  - Chrome 90+
  - Safari 14+
  - Firefox 85+
  - Edge 90+
- **测试步骤**:
  1. 在各浏览器中运行WebGL版本
  2. 测试核心功能
- **预期结果**:
  - 所有主流浏览器兼容
  - 功能正常
  - 性能可接受

---

### 5.2 分辨率适配

#### TC-COMPAT-004: 常见分辨率测试
- **优先级**: P0
- **测试分辨率**:
  - 720x1280 (HD)
  - 1080x1920 (FHD)
  - 1125x2436 (iPhone X)
  - 1440x2960 (QHD)
- **测试步骤**:
  1. 在各分辨率下启动游戏
  2. 验证布局和显示
- **预期结果**:
  - 布局自适应
  - Symbol清晰无失真
  - 间距和尺寸比例正确

#### TC-COMPAT-005: 横竖屏切换
- **优先级**: P2
- **前置条件**: 支持横竖屏切换（如果需要）
- **测试步骤**:
  1. 旋转设备切换横竖屏
  2. 验证布局调整
- **预期结果**:
  - 布局正确重排
  - 无显示错位
  - 功能正常

#### TC-COMPAT-006: 异形屏适配
- **优先级**: P2
- **测试设备**:
  - iPhone X系列（刘海屏）
  - 挖孔屏Android设备
- **测试步骤**:
  1. 验证安全区域
  2. 检查UI元素是否被遮挡
- **预期结果**:
  - UI不被刘海/挖孔遮挡
  - 游戏区域完整显示
  - 布局合理

---

## 六、集成测试用例

### 6.1 模块交互测试

#### TC-INT-001: SlotMachine与ReelController交互
- **优先级**: P0
- **前置条件**: 执行spin操作
- **测试步骤**:
  1. 验证SlotMachine正确调用各ReelController
  2. 验证停止信号传递
  3. 验证回调触发
- **预期结果**:
  - 5个ReelController正确响应
  - 停止时序准确
  - 回调正确触发

#### TC-INT-002: GridManager与SymbolItem交互
- **优先级**: P1
- **前置条件**: 获取指定位置的symbol
- **测试步骤**:
  1. 调用getSymbolAt(row, col)
  2. 验证返回的SymbolItem
  3. 修改symbol并验证网格更新
- **预期结果**:
  - 返回正确的SymbolItem实例
  - 坐标映射准确
  - 数据同步

#### TC-INT-003: WinAnimationController与SymbolItem交互
- **优先级**: P1
- **前置条件**: 触发中奖动画
- **测试步骤**:
  1. 验证Controller正确获取symbol实例
  2. 验证动画指令传递
  3. 验证完成回调
- **预期结果**:
  - 正确的symbol播放动画
  - 动画同步控制
  - 完成后正确回调

#### TC-INT-004: ResultManager数据流转
- **优先级**: P1
- **前置条件**: 设置并获取结果
- **测试步骤**:
  1. setNextResult()
  2. getNextResult()
  3. 验证数据一致性
- **预期结果**:
  - 数据完整传递
  - 验证逻辑正确
  - 无数据丢失

---

### 6.2 完整流程测试

#### TC-INT-005: 标准中奖流程
- **优先级**: P0
- **前置条件**: 准备一条线中奖的数据
- **测试步骤**:
  1. 点击Spin
  2. 观察完整流程
  3. 验证每个阶段
- **预期结果**:
  - 流程完整: 按钮禁用 → 滚动 → 逐列停止 → 回弹 → 中奖动画 → 按钮恢复
  - 时序正确
  - 数据准确

#### TC-INT-006: 无中奖流程
- **优先级**: P1
- **前置条件**: winPositions为空
- **测试步骤**:
  1. 执行spin
  2. 观察完整流程
- **预期结果**:
  - 流程: 按钮禁用 → 滚动 → 停止 → 回弹 → 按钮恢复
  - 跳过中奖动画阶段
  - 正常返回IDLE

#### TC-INT-007: 连续多次不同结果
- **优先级**: P1
- **前置条件**: 准备5组不同结果
- **测试步骤**:
  1. 连续执行5次spin
  2. 每次使用不同结果
  3. 验证每次的准确性
- **预期结果**:
  - 每次结果独立正确
  - 状态转换正常
  - 无数据混乱

---

## 七、用户体验测试用例

### 7.1 交互体验

#### TC-UX-001: 动画流畅度主观评价
- **优先级**: P1
- **前置条件**: 10位测试人员
- **测试步骤**:
  1. 执行10次spin
  2. 测试人员评分（1-5分）
- **预期结果**:
  - 平均分≥4.0
  - 无明显卡顿感
  - 动画自然

#### TC-UX-002: 响应速度体验
- **优先级**: P1
- **前置条件**: 测试人员操作
- **测试步骤**:
  1. 点击按钮
  2. 评价响应时间
- **预期结果**:
  - 感觉瞬时响应
  - 无延迟感
  - 反馈及时

#### TC-UX-003: 视觉效果评价
- **优先级**: P2
- **前置条件**: 完整的美术资源
- **测试步骤**:
  1. 观察整体视觉
  2. 评价美术效果
- **预期结果**:
  - 视觉统一协调
  - Symbol清晰易辨
  - 动画吸引人

---

### 7.2 易用性测试

#### TC-UX-004: 新用户首次使用
- **优先级**: P1
- **前置条件**: 从未玩过的用户
- **测试步骤**:
  1. 观察用户是否能快速理解
  2. 记录首次操作时间
- **预期结果**:
  - 5秒内找到Spin按钮
  - 无困惑
  - 流程直观

#### TC-UX-005: 错误操作容错
- **优先级**: P2
- **前置条件**: 用户误操作
- **测试步骤**:
  1. 在不恰当时机点击
  2. 观察系统反应
- **预期结果**:
  - 系统稳定
  - 无崩溃
  - 有明确反馈（如按钮禁用状态）

---

## 八、自动化测试建议

### 8.1 自动化测试脚本

#### TC-AUTO-001: 回归测试套件
- **覆盖范围**:
  - 所有P0核心功能
  - 常见的P1功能
- **执行频率**: 每次代码提交
- **预期结果**: 100%通过

#### TC-AUTO-002: 性能基准测试
- **测试内容**:
  - FPS监控
  - 内存监控
  - DrawCall统计
- **执行频率**: 每日构建
- **预期结果**: 性能指标符合基准

#### TC-AUTO-003: 压力测试
- **测试内容**:
  - 连续1000次spin
  - 长时间运行（4小时）
- **执行频率**: 每周一次
- **预期结果**: 无崩溃、无内存泄漏

---

## 九、测试数据集

### 9.1 标准测试数据

#### 数据集1: 单线中奖（中间行）
```json
{
  "name": "single_line_middle",
  "finalLayout": [
    [3, 7, 2, 9, 5],
    [7, 7, 7, 7, 7],
    [2, 8, 2, 5, 9]
  ],
  "winPositions": [
    {"row": 1, "col": 0, "symbolId": 7},
    {"row": 1, "col": 1, "symbolId": 7},
    {"row": 1, "col": 2, "symbolId": 7},
    {"row": 1, "col": 3, "symbolId": 7},
    {"row": 1, "col": 4, "symbolId": 7}
  ]
}
```

#### 数据集2: 双线中奖（上下行）
```json
{
  "name": "double_line_top_bottom",
  "finalLayout": [
    [3, 3, 3, 3, 3],
    [5, 7, 2, 9, 1],
    [8, 8, 8, 8, 8]
  ],
  "winPositions": [
    {"row": 0, "col": 0, "symbolId": 3},
    {"row": 0, "col": 1, "symbolId": 3},
    {"row": 0, "col": 2, "symbolId": 3},
    {"row": 0, "col": 3, "symbolId": 3},
    {"row": 0, "col": 4, "symbolId": 3},
    {"row": 2, "col": 0, "symbolId": 8},
    {"row": 2, "col": 1, "symbolId": 8},
    {"row": 2, "col": 2, "symbolId": 8},
    {"row": 2, "col": 3, "symbolId": 8},
    {"row": 2, "col": 4, "symbolId": 8}
  ]
}
```

#### 数据集3: 无中奖
```json
{
  "name": "no_win",
  "finalLayout": [
    [1, 3, 5, 7, 2],
    [4, 6, 8, 3, 5],
    [2, 9, 1, 4, 6]
  ],
  "winPositions": []
}
```

#### 数据集4: 全屏中奖
```json
{
  "name": "full_screen_win",
  "finalLayout": [
    [7, 7, 7, 7, 7],
    [7, 7, 7, 7, 7],
    [7, 7, 7, 7, 7]
  ],
  "winPositions": [
    {"row": 0, "col": 0, "symbolId": 7},
    {"row": 0, "col": 1, "symbolId": 7},
    {"row": 0, "col": 2, "symbolId": 7},
    {"row": 0, "col": 3, "symbolId": 7},
    {"row": 0, "col": 4, "symbolId": 7},
    {"row": 1, "col": 0, "symbolId": 7},
    {"row": 1, "col": 1, "symbolId": 7},
    {"row": 1, "col": 2, "symbolId": 7},
    {"row": 1, "col": 3, "symbolId": 7},
    {"row": 1, "col": 4, "symbolId": 7},
    {"row": 2, "col": 0, "symbolId": 7},
    {"row": 2, "col": 1, "symbolId": 7},
    {"row": 2, "col": 2, "symbolId": 7},
    {"row": 2, "col": 3, "symbolId": 7},
    {"row": 2, "col": 4, "symbolId": 7}
  ]
}
```

#### 数据集5: 散点中奖
```json
{
  "name": "scattered_win",
  "finalLayout": [
    [1, 7, 5, 2, 9],
    [4, 3, 7, 8, 5],
    [2, 9, 1, 7, 6]
  ],
  "winPositions": [
    {"row": 0, "col": 1, "symbolId": 7},
    {"row": 1, "col": 2, "symbolId": 7},
    {"row": 2, "col": 3, "symbolId": 7}
  ]
}
```

---

## 十、缺陷分级标准

### 10.1 缺陷优先级

#### P0 - 致命缺陷（Blocker）
- 游戏崩溃或无法启动
- 核心功能完全不可用
- 数据丢失或严重错误
- 示例: Spin按钮点击无响应、滚轴不停止

#### P1 - 严重缺陷（Critical）
- 主要功能受影响但有临时解决方案
- 性能严重不达标（FPS<30）
- 明显的视觉错误
- 示例: 停止位置偏差>5px、动画卡顿严重

#### P2 - 一般缺陷（Major）
- 次要功能异常
- 轻微的视觉问题
- 性能略低于目标
- 示例: 回弹效果不够自然、某个symbol动画帧缺失

#### P3 - 轻微缺陷（Minor）
- 不影响功能的小问题
- 优化建议
- 体验优化建议
- 示例: 日志输出格式、注释不完整

---

## 十一、测试报告模板

### 11.1 测试执行记录

| 测试用例ID | 测试标题 | 执行日期 | 执行人 | 测试结果 | 缺陷ID | 备注 |
|-----------|---------|---------|--------|---------|--------|------|
| TC-INIT-001 | 初始布局显示 | 2025-12-25 | 测试员A | 通过 | - | - |
| TC-SPIN-001 | 基本滚动动画 | 2025-12-25 | 测试员A | 失败 | BUG-001 | 滚动速度偏慢 |
| ... | ... | ... | ... | ... | ... | ... |

### 11.2 测试总结模板

```markdown
## 测试总结报告

**测试日期**: 2025-12-25
**测试版本**: v1.0.0
**测试人员**: 测试团队

### 一、测试概况
- 计划测试用例数: 120
- 实际执行用例数: 118
- 通过用例数: 105
- 失败用例数: 13
- 阻塞未执行: 2

### 二、测试结论
- [ ] 通过，可以发布
- [x] 有缺陷，需修复后回归
- [ ] 严重问题，不建议发布

### 三、主要问题
1. **BUG-001**: 滚动速度比预期慢20%（P1）
2. **BUG-002**: 全屏中奖时FPS降到45（P1）
3. **BUG-003**: Android设备内存增长10MB（P1）

### 四、性能数据
- 平均FPS: 57
- 平均内存: 85MB
- 平均DrawCall: 32
- 加载时间: 2.5s

### 五、建议
1. 优化全屏动画播放的性能
2. 修复内存泄漏问题
3. 调整滚动速度配置
```

---

## 十二、测试排期

### 12.1 测试阶段划分

#### 阶段1: 功能测试（3天）
- Day 1: 初始化、按钮、滚动模块
- Day 2: 停止机制、状态管理
- Day 3: 中奖动画、完整流程

#### 阶段2: 边界与集成测试（2天）
- Day 4: 边界测试、异常数据测试
- Day 5: 集成测试、模块交互测试

#### 阶段3: 性能与兼容性测试（2天）
- Day 6: 性能测试（FPS、内存、渲染）
- Day 7: 兼容性测试（设备、浏览器）

#### 阶段4: 回归与验收（2天）
- Day 8: 缺陷修复后回归测试
- Day 9: 最终验收测试

**总计: 9个工作日**

---

## 十三、测试工具

### 13.1 推荐工具

#### 性能分析工具
- **Cocos Creator自带Profiler**: FPS、DrawCall、内存监控
- **Chrome DevTools**: WebGL版本性能分析
- **Xcode Instruments**: iOS设备性能分析
- **Android Profiler**: Android设备性能分析

#### 自动化工具
- **Cocos Creator脚本**: 自动化执行spin
- **Jest**: 单元测试框架
- **Puppeteer**: WebGL版本自动化测试

#### 截图/录屏工具
- **OBS Studio**: 录制测试视频
- **ScreenToGif**: 制作GIF演示
- **手机自带截图**: 记录问题

---

## 附录A: 测试检查清单

### 开始测试前
- [ ] 测试环境已搭建
- [ ] 测试设备已准备
- [ ] 测试数据已配置
- [ ] 性能监控工具已安装
- [ ] 测试用例已评审

### 测试执行中
- [ ] 详细记录每个用例结果
- [ ] 截图/录屏记录问题
- [ ] 及时提交缺陷报告
- [ ] 性能数据记录完整
- [ ] 特殊情况及时沟通

### 测试完成后
- [ ] 所有用例已执行
- [ ] 测试报告已完成
- [ ] 缺陷已提交跟踪
- [ ] 测试数据已归档
- [ ] 总结会议已召开

---

## 附录B: 常见问题处理

### 问题1: 测试环境搭建失败
**解决方案**:
1. 检查Cocos Creator版本（2.4.11）
2. 验证资源文件完整性
3. 检查配置文件格式
4. 查看控制台错误日志

### 问题2: 性能数据采集困难
**解决方案**:
1. 使用Cocos自带Profiler
2. 启用Stats显示（显示FPS和DrawCall）
3. 编写性能日志脚本
4. 使用第三方性能监控工具

### 问题3: 自动化测试实施困难
**解决方案**:
1. 先手动测试验证
2. 逐步自动化核心流程
3. 使用脚本模拟点击
4. 定时截图对比验证

---

**文档结束**

如有测试相关问题，请联系测试负责人或开发团队。
